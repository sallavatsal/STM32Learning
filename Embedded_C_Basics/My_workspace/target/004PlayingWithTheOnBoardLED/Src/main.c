/**
  ******************************************************************************
  * @file    main.c
  * @author  Auto-generated by STM32CubeIDE
  * @version V1.0
  * @brief   Default main function.
  ******************************************************************************
*/

#include<stdio.h>
#include<stdint.h>

int main(){
	// Addresses as pointers
	uint32_t* pClkCtrlreg = (uint32_t*)(0x40023830);		// RCC_AHB1ENR Clock enable register
	uint32_t* pPortDModereg = (uint32_t*)(0x40020C00);		// GPIO D Control Mode
	uint32_t* pPortDOutreg = (uint32_t*)(0x40020C14);		// GPIO D Output Data register
	uint32_t* pPortAModereg = (uint32_t*)(0x40020000);		// GPIO A Control Mode
	uint32_t* pPortAInreg = (uint32_t*)(0x40020010);		// GPIO A Input Data Mode

	// To not affect other registers, use bit manipulation.
	*pClkCtrlreg |= (1<<3);									// Clock enabled for Port D
	*pClkCtrlreg |= (1<<0);									// Clock enabled for Port A
	*pPortDModereg &= ~(3<<24);								// Clear 24th and 25th bit
	*pPortDModereg |= (1<<24);								// Set 24th bit
	*pPortAModereg &= ~(3<<0);								// Clear 1st and 2nd Bit

	// Toggling LED
	while(1){
		*pPortDOutreg |= (1<<12);							// Setting the 12th bit
		for(int i=0; i<300000; ++i);
		*pPortDOutreg &= ~(1<<12);							// Clearing the 12th bit
		for(int i=0; i<300000; ++i);
	}

	/*	while(1){
			uint8_t pinStatus = *pPortAInreg & 1;
			if(pinStatus)
				*pPortDOutreg |= (1<<12);						// LED On
			else
				*pPortDOutreg &= ~(1<<12);						// LED Off
		}
	*/

	return 0;
}
